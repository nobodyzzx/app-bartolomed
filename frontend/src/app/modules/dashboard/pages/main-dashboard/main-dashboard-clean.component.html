<div class="main-dashboard-container">
  <div class="main-dashboard-content">
    <!-- Encabezado del Dashboard -->
    <div class="text-center mb-8">
      <h1 class="text-4xl font-bold text-blue-900 mb-4">Dashboard Principal</h1>
      <div class="w-24 h-1 bg-blue-600 mx-auto rounded-full mb-4"></div>
      <p class="text-lg text-blue-600">Centro de control del sistema médico - Vista general</p>
    </div>

    <!-- Métricas Principales -->
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
      <!-- Total Pacientes -->
      <div class="bg-gradient-to-br from-blue-500 to-blue-600 p-6 rounded-2xl text-white shadow-lg">
        <div class="flex items-center justify-between">
          <div>
            <p class="text-blue-100 text-sm font-medium">Total Pacientes</p>
            <p class="text-3xl font-bold">{{stats.totalPatients}}</p>
            <p class="text-blue-100 text-xs mt-1">
              Registrados en el sistema
            </p>
          </div>
          <mat-icon class="text-5xl text-blue-200">people</mat-icon>
        </div>
      </div>

      <!-- Citas Hoy -->
      <div class="bg-gradient-to-br from-green-500 to-green-600 p-6 rounded-2xl text-white shadow-lg">
        <div class="flex items-center justify-between">
          <div>
            <p class="text-green-100 text-sm font-medium">Citas Programadas</p>
            <p class="text-3xl font-bold">{{stats.totalAppointments}}</p>
            <p class="text-green-100 text-xs mt-1">
              Este mes
            </p>
          </div>
          <mat-icon class="text-5xl text-green-200">calendar_today</mat-icon>
        </div>
      </div>

      <!-- Total Doctores -->
      <div class="bg-gradient-to-br from-purple-500 to-purple-600 p-6 rounded-2xl text-white shadow-lg">
        <div class="flex items-center justify-between">
          <div>
            <p class="text-purple-100 text-sm font-medium">Doctores Activos</p>
            <p class="text-3xl font-bold">{{stats.totalDoctors}}</p>
            <p class="text-purple-100 text-xs mt-1">
              Personal médico
            </p>
          </div>
          <mat-icon class="text-5xl text-purple-200">medical_services</mat-icon>
        </div>
      </div>

      <!-- Ingresos del Mes -->
      <div class="bg-gradient-to-br from-orange-500 to-orange-600 p-6 rounded-2xl text-white shadow-lg">
        <div class="flex items-center justify-between">
          <div>
            <p class="text-orange-100 text-sm font-medium">Ingresos del Mes</p>
            <p class="text-3xl font-bold">${{stats.monthlyRevenue | number}}</p>
            <p class="text-orange-100 text-xs mt-1">
              Facturación mensual
            </p>
          </div>
          <mat-icon class="text-5xl text-orange-200">attach_money</mat-icon>
        </div>
      </div>
    </div>

    <!-- Sección de contenido principal -->
    <div class="grid grid-cols-1 xl:grid-cols-2 gap-8 mb-8">
      
      <!-- Citas Recientes -->
      <div class="bg-white p-6 rounded-2xl shadow-lg">
        <div class="flex items-center justify-between mb-6">
          <h2 class="text-2xl font-bold text-blue-900">Citas Recientes</h2>
          <button mat-button color="primary" routerLink="/dashboard/appointments">
            Ver todas
          </button>
        </div>
        
        <div class="overflow-x-auto">
          <table mat-table [dataSource]="recentAppointments" class="w-full">
            <!-- Columna Paciente -->
            <ng-container matColumnDef="patient">
              <th mat-header-cell *matHeaderCellDef class="text-left font-semibold">Paciente</th>
              <td mat-cell *matCellDef="let appointment">{{appointment.patientName}}</td>
            </ng-container>

            <!-- Columna Doctor -->
            <ng-container matColumnDef="doctor">
              <th mat-header-cell *matHeaderCellDef class="text-left font-semibold">Doctor</th>
              <td mat-cell *matCellDef="let appointment">{{appointment.doctorName}}</td>
            </ng-container>

            <!-- Columna Hora -->
            <ng-container matColumnDef="time">
              <th mat-header-cell *matHeaderCellDef class="text-left font-semibold">Hora</th>
              <td mat-cell *matCellDef="let appointment">{{appointment.time}}</td>
            </ng-container>

            <!-- Columna Tipo -->
            <ng-container matColumnDef="type">
              <th mat-header-cell *matHeaderCellDef class="text-left font-semibold">Tipo</th>
              <td mat-cell *matCellDef="let appointment">{{appointment.type}}</td>
            </ng-container>

            <!-- Columna Estado -->
            <ng-container matColumnDef="status">
              <th mat-header-cell *matHeaderCellDef class="text-left font-semibold">Estado</th>
              <td mat-cell *matCellDef="let appointment">
                <mat-chip [color]="getStatusColor(appointment.status)">
                  {{getStatusText(appointment.status)}}
                </mat-chip>
              </td>
            </ng-container>

            <!-- Columna Acciones -->
            <ng-container matColumnDef="actions">
              <th mat-header-cell *matHeaderCellDef class="text-left font-semibold">Acciones</th>
              <td mat-cell *matCellDef="let appointment">
                <button mat-icon-button (click)="viewAppointmentDetails(appointment)" matTooltip="Ver detalles">
                  <mat-icon>visibility</mat-icon>
                </button>
                <button mat-icon-button (click)="editAppointment(appointment)" matTooltip="Editar">
                  <mat-icon>edit</mat-icon>
                </button>
              </td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
          </table>
        </div>
      </div>

      <!-- Alertas de Stock -->
      <div class="bg-white p-6 rounded-2xl shadow-lg">
        <div class="flex items-center justify-between mb-6">
          <h2 class="text-2xl font-bold text-blue-900">Alertas de Stock</h2>
          <button mat-button color="warn" routerLink="/dashboard/pharmacy-inventory">
            Ver inventario
          </button>
        </div>
        
        <div class="space-y-4">
          <div *ngFor="let alert of stockAlerts" class="p-4 bg-red-50 border-l-4 border-red-400 rounded-lg">
            <div class="flex justify-between items-start">
              <div>
                <h3 class="font-semibold text-red-800">{{alert.medication}}</h3>
                <p class="text-sm text-red-600">{{alert.category}}</p>
                <p class="text-sm text-red-700 mt-1">
                  Stock actual: <span class="font-bold">{{alert.currentStock}}</span> 
                  / Mínimo: <span class="font-bold">{{alert.minimumStock}}</span>
                </p>
              </div>
              <button mat-mini-fab color="warn" (click)="restockMedication(alert)" matTooltip="Reabastecer">
                <mat-icon>add</mat-icon>
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Pacientes Recientes -->
    <div class="bg-white p-6 rounded-2xl shadow-lg">
      <div class="flex items-center justify-between mb-6">
        <h2 class="text-2xl font-bold text-blue-900">Pacientes Recientes</h2>
        <button mat-button color="primary" routerLink="/dashboard/patients">
          Ver todos los pacientes
        </button>
      </div>
      
      <div class="overflow-x-auto">
        <table mat-table [dataSource]="recentPatients" class="w-full">
          <!-- Columna Nombre -->
          <ng-container matColumnDef="name">
            <th mat-header-cell *matHeaderCellDef class="text-left font-semibold">Nombre</th>
            <td mat-cell *matCellDef="let patient">{{patient.name}}</td>
          </ng-container>

          <!-- Columna Edad -->
          <ng-container matColumnDef="age">
            <th mat-header-cell *matHeaderCellDef class="text-left font-semibold">Edad</th>
            <td mat-cell *matCellDef="let patient">{{patient.age}} años</td>
          </ng-container>

          <!-- Columna Última Visita -->
          <ng-container matColumnDef="lastVisit">
            <th mat-header-cell *matHeaderCellDef class="text-left font-semibold">Última Visita</th>
            <td mat-cell *matCellDef="let patient">{{patient.lastVisit | date:'short'}}</td>
          </ng-container>

          <!-- Columna Próxima Cita -->
          <ng-container matColumnDef="nextAppointment">
            <th mat-header-cell *matHeaderCellDef class="text-left font-semibold">Próxima Cita</th>
            <td mat-cell *matCellDef="let patient">
              {{patient.nextAppointment ? (patient.nextAppointment | date:'short') : 'No programada'}}
            </td>
          </ng-container>

          <!-- Columna Estado -->
          <ng-container matColumnDef="status">
            <th mat-header-cell *matHeaderCellDef class="text-left font-semibold">Estado</th>
            <td mat-cell *matCellDef="let patient">
              <mat-chip [color]="getStatusColor(patient.status)">
                {{getStatusText(patient.status)}}
              </mat-chip>
            </td>
          </ng-container>

          <!-- Columna Acciones -->
          <ng-container matColumnDef="actions">
            <th mat-header-cell *matHeaderCellDef class="text-left font-semibold">Acciones</th>
            <td mat-cell *matCellDef="let patient">
              <button mat-icon-button (click)="viewPatientDetails(patient)" matTooltip="Ver perfil">
                <mat-icon>person</mat-icon>
              </button>
              <button mat-icon-button (click)="scheduleAppointment(patient)" matTooltip="Programar cita">
                <mat-icon>event_available</mat-icon>
              </button>
            </td>
          </ng-container>

          <tr mat-header-row *matHeaderRowDef="patientColumns"></tr>
          <tr mat-row *matRowDef="let row; columns: patientColumns;"></tr>
        </table>
      </div>
    </div>

    <!-- Acciones Rápidas -->
    <div class="mt-8 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
      <button mat-raised-button color="primary" routerLink="/dashboard/patients/new" class="p-4 h-auto">
        <mat-icon class="mb-2">person_add</mat-icon>
        <div>Registrar Paciente</div>
      </button>
      
      <button mat-raised-button color="accent" routerLink="/dashboard/appointments/new" class="p-4 h-auto">
        <mat-icon class="mb-2">event_available</mat-icon>
        <div>Nueva Cita</div>
      </button>
      
      <button mat-raised-button color="warn" routerLink="/dashboard/pharmacy/inventory" class="p-4 h-auto">
        <mat-icon class="mb-2">inventory</mat-icon>
        <div>Inventario</div>
      </button>
      
      <button mat-raised-button routerLink="/dashboard/medical-reports" class="p-4 h-auto">
        <mat-icon class="mb-2">analytics</mat-icon>
        <div>Reportes</div>
      </button>
    </div>
  </div>
</div>
