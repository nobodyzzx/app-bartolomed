<div class="min-h-screen bg-slate-50 p-8">
  <div class="max-w-7xl mx-auto">
    <!-- Header -->
    <div class="flex items-center justify-between mb-10">
      <div class="flex items-center gap-4">
        <button
          type="button"
          (click)="navigateToDashboard()"
          class="inline-flex items-center justify-center w-11 h-11 rounded-full bg-blue-50 text-blue-600 hover:bg-blue-100 hover:text-blue-700 shadow-md hover:shadow-lg focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-200 focus-visible:ring-offset-1 transition-all border-0"
          matTooltip="Volver al dashboard"
          aria-label="Volver al dashboard"
        >
          <mat-icon class="!text-[20px] leading-none">arrow_back</mat-icon>
        </button>
        <div class="text-left">
          <h1 class="text-3xl md:text-4xl font-bold text-slate-900 mb-0.5">Lista de Clínicas</h1>
          <p class="text-slate-600">Gestiona todas tus clínicas</p>
        </div>
      </div>
      <button
        type="button"
        (click)="navigateToNew()"
        class="inline-flex items-center gap-2 px-5 py-2.5 rounded-full font-medium bg-blue-50 text-blue-600 hover:bg-blue-100 hover:text-blue-700 shadow-md hover:shadow-lg focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-200 focus-visible:ring-offset-1 transition-all border-0"
        aria-label="Crear nueva clínica"
      >
        <mat-icon class="!text-[20px] leading-none">add</mat-icon>
        Nueva Clínica
      </button>
    </div>

    <!-- Search and Filter Controls -->
    <div class="bg-white rounded-xl shadow-sm border border-slate-200 p-6 mb-8">
      <!-- Search -->
      <div class="flex items-center gap-4 mb-6">
        <div class="flex-1 max-w-2xl">
          <div class="relative">
            <input
              type="text"
              [(ngModel)]="searchTerm"
              (input)="applyFilter($event)"
              placeholder="Buscar clínicas..."
              class="w-full h-11 rounded-full bg-blue-50 px-5 pr-12 text-slate-900 placeholder-blue-400/70 shadow-md hover:bg-blue-100 hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-blue-200 focus:ring-offset-1 focus:bg-white transition border-0"
            />
            <mat-icon class="absolute right-3 top-2.5 text-blue-400">search</mat-icon>
          </div>
        </div>

        <button
          type="button"
          (click)="searchClinics()"
          [disabled]="!searchTerm.trim()"
          class="inline-flex items-center gap-2 px-5 h-11 rounded-full font-medium bg-blue-50 text-blue-600 hover:bg-blue-100 hover:text-blue-700 shadow-md hover:shadow-lg focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-200 focus-visible:ring-offset-1 transition-all disabled:opacity-60 disabled:cursor-not-allowed border-0"
        >
          <mat-icon class="!text-[18px]">search</mat-icon>
          Buscar
        </button>
      </div>

      <!-- Filter by Status -->
      <div class="flex flex-wrap gap-3">
        <button
          type="button"
          (click)="setFilterStatus('all')"
          [ngClass]="{
            'bg-blue-600 text-white shadow-md': filterStatus === 'all',
            'bg-blue-50 text-blue-400 hover:bg-blue-100 hover:text-blue-600':
              filterStatus !== 'all',
          }"
          class="inline-flex items-center gap-2 px-4 py-2 rounded-full font-medium transition-all border-0 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-200 focus-visible:ring-offset-1"
        >
          <mat-icon class="!text-[18px]">done_all</mat-icon>
          Todas ({{ allClinics.length }})
        </button>
        <button
          type="button"
          (click)="setFilterStatus('active')"
          [ngClass]="{
            'bg-green-600 text-white shadow-md': filterStatus === 'active',
            'bg-green-50 text-green-400 hover:bg-green-100 hover:text-green-600':
              filterStatus !== 'active',
          }"
          class="inline-flex items-center gap-2 px-4 py-2 rounded-full font-medium transition-all border-0 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-green-200 focus-visible:ring-offset-1"
        >
          <mat-icon class="!text-[18px]">check_circle</mat-icon>
          Activas ({{ getActiveClinicsCount() }})
        </button>
        <button
          type="button"
          (click)="setFilterStatus('inactive')"
          [ngClass]="{
            'bg-red-600 text-white shadow-md': filterStatus === 'inactive',
            'bg-red-50 text-red-400 hover:bg-red-100 hover:text-red-600':
              filterStatus !== 'inactive',
          }"
          class="inline-flex items-center gap-2 px-4 py-2 rounded-full font-medium transition-all border-0 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-red-200 focus-visible:ring-offset-1"
        >
          <mat-icon class="!text-[18px]">cancel</mat-icon>
          Inactivas ({{ getInactiveClinicsCount() }})
        </button>
      </div>
    </div>

    <!-- Loading indicator -->
    <div *ngIf="isLoading" class="flex justify-center items-center py-20">
      <mat-spinner diameter="60"></mat-spinner>
    </div>

    <!-- Table Card -->
    <div
      *ngIf="!isLoading"
      class="bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden"
    >
      <div class="overflow-x-auto">
        <table mat-table [dataSource]="dataSource" matSort class="w-full bg-transparent">
          <!-- Name Column -->
          <ng-container matColumnDef="name">
            <th
              mat-header-cell
              *matHeaderCellDef
              mat-sort-header
              class="bg-slate-100 text-slate-800 font-semibold p-4 text-left"
            >
              Nombre
            </th>
            <td mat-cell *matCellDef="let clinic" class="p-4">
              <div class="flex items-center gap-3">
                <div class="w-10 h-10 rounded-lg bg-blue-100 flex items-center justify-center">
                  <mat-icon class="text-blue-600">business</mat-icon>
                </div>
                <div>
                  <div class="font-medium text-slate-900">{{ clinic.name }}</div>
                  <div class="text-sm text-slate-500" *ngIf="clinic.description">
                    {{ clinic.description }}
                  </div>
                </div>
              </div>
            </td>
          </ng-container>

          <!-- Address Column -->
          <ng-container matColumnDef="address">
            <th
              mat-header-cell
              *matHeaderCellDef
              class="bg-slate-100 text-slate-800 font-semibold p-4 text-left"
            >
              Dirección
            </th>
            <td mat-cell *matCellDef="let clinic" class="p-4">
              <div>
                <div class="text-slate-900 font-medium">{{ clinic.address }}</div>
                <div
                  class="text-sm text-slate-500"
                  *ngIf="clinic.departamento || clinic.provincia || clinic.localidad"
                >
                  <ng-container *ngIf="clinic.departamento">{{ clinic.departamento }}</ng-container>
                  <ng-container *ngIf="clinic.provincia"> - {{ clinic.provincia }}</ng-container>
                  <ng-container *ngIf="clinic.localidad"> - {{ clinic.localidad }}</ng-container>
                </div>
              </div>
            </td>
          </ng-container>

          <!-- Phone Column -->
          <ng-container matColumnDef="phone">
            <th
              mat-header-cell
              *matHeaderCellDef
              class="bg-slate-100 text-slate-800 font-semibold p-4 text-left"
            >
              Teléfono
            </th>
            <td mat-cell *matCellDef="let clinic" class="p-4">
              <div class="flex items-center gap-2 text-slate-900">
                <mat-icon class="text-slate-400 text-lg">phone</mat-icon>
                {{ clinic.phone }}
              </div>
            </td>
          </ng-container>

          <!-- Email Column -->
          <ng-container matColumnDef="email">
            <th
              mat-header-cell
              *matHeaderCellDef
              class="bg-slate-100 text-slate-800 font-semibold p-4 text-left"
            >
              Email
            </th>
            <td mat-cell *matCellDef="let clinic" class="p-4">
              <div class="flex items-center gap-2 text-slate-900" *ngIf="clinic.email">
                <mat-icon class="text-slate-400 text-lg">email</mat-icon>
                {{ clinic.email }}
              </div>
              <span *ngIf="!clinic.email" class="text-slate-400">-</span>
            </td>
          </ng-container>

          <!-- Status Column -->
          <ng-container matColumnDef="isActive">
            <th
              mat-header-cell
              *matHeaderCellDef
              class="bg-slate-100 text-slate-800 font-semibold p-4 text-left"
            >
              Estado
            </th>
            <td mat-cell *matCellDef="let clinic" class="p-4">
              <span
                class="inline-flex items-center gap-2 px-3 py-1 rounded-full text-xs font-medium border"
                [ngClass]="{
                  'bg-green-100 text-green-800 border-green-200': clinic.isActive,
                  'bg-red-100 text-red-800 border-red-200': !clinic.isActive,
                }"
              >
                <span
                  class="w-2 h-2 rounded-full"
                  [ngClass]="clinic.isActive ? 'bg-green-500' : 'bg-red-500'"
                ></span>
                {{ clinic.isActive ? 'Activo' : 'Inactivo' }}
              </span>
            </td>
          </ng-container>

          <!-- Actions Column -->
          <ng-container matColumnDef="actions">
            <th
              mat-header-cell
              *matHeaderCellDef
              class="bg-slate-100 text-slate-800 font-semibold p-4 text-left"
            >
              Acciones
            </th>
            <td mat-cell *matCellDef="let clinic" class="p-4">
              <div class="flex items-center gap-2">
                <button
                  mat-icon-button
                  (click)="viewClinic(clinic)"
                  class="w-9 h-9 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-1 focus-visible:ring-blue-200"
                  matTooltip="Ver detalles"
                  aria-label="Ver detalles de la clínica"
                >
                  <mat-icon class="!text-[20px] leading-none">visibility</mat-icon>
                </button>

                <button
                  mat-icon-button
                  (click)="editClinic(clinic)"
                  class="w-9 h-9 text-amber-600 hover:bg-amber-50 rounded-lg transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-1 focus-visible:ring-amber-200"
                  matTooltip="Editar"
                  aria-label="Editar clínica"
                >
                  <mat-icon class="!text-[20px] leading-none">edit</mat-icon>
                </button>

                <button
                  mat-icon-button
                  (click)="toggleClinicStatus(clinic)"
                  [ngClass]="{
                    'text-red-600 hover:bg-red-50 focus-visible:ring-red-200': clinic.isActive,
                    'text-green-600 hover:bg-green-50 focus-visible:ring-green-200':
                      !clinic.isActive,
                  }"
                  [matTooltip]="clinic.isActive ? 'Desactivar' : 'Activar'"
                  class="w-9 h-9 rounded-lg transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-1"
                  [attr.aria-label]="clinic.isActive ? 'Desactivar clínica' : 'Activar clínica'"
                >
                  <mat-icon class="!text-[20px] leading-none">{{
                    clinic.isActive ? 'block' : 'check_circle'
                  }}</mat-icon>
                </button>

                <button
                  mat-icon-button
                  (click)="deleteClinic(clinic)"
                  class="w-9 h-9 text-red-600 hover:bg-red-50 rounded-lg transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-1 focus-visible:ring-red-200"
                  matTooltip="Eliminar"
                  aria-label="Eliminar clínica"
                >
                  <mat-icon class="!text-[20px] leading-none">delete</mat-icon>
                </button>
              </div>
            </td>
          </ng-container>

          <tr
            mat-header-row
            *matHeaderRowDef="displayedColumns"
            class="border-b-2 border-slate-200"
          ></tr>
          <tr
            mat-row
            *matRowDef="let row; columns: displayedColumns"
            class="border-b border-slate-100 hover:bg-slate-50 transition-colors"
          ></tr>
        </table>
      </div>

      <!-- Paginator -->
      <div class="bg-slate-50 border-t border-slate-200">
        <mat-paginator
          [pageSizeOptions]="[5, 10, 20, 50]"
          showFirstLastButtons
          class="bg-transparent"
        ></mat-paginator>
      </div>
    </div>

    <!-- No data message -->
    <div
      *ngIf="!isLoading && dataSource.data.length === 0"
      class="bg-white rounded-xl shadow-sm border border-slate-200 text-center py-20"
    >
      <mat-icon class="text-6xl text-slate-300 mb-4">business</mat-icon>
      <h3 class="text-2xl font-bold text-slate-900 mb-2">No se encontraron clínicas</h3>
      <p class="text-slate-600 mb-6">No hay clínicas registradas en el sistema.</p>
      <button
        type="button"
        (click)="navigateToNew()"
        class="inline-flex items-center gap-2 px-6 py-3 bg-blue-600 text-white font-medium rounded-lg hover:bg-blue-700 transition-colors shadow-sm"
      >
        <mat-icon>add</mat-icon>
        Crear Primera Clínica
      </button>
    </div>
  </div>
</div>
